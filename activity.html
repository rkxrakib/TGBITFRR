<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div style="padding: 25px 20px;">
        <h4 style="color:var(--acc-sec); margin-bottom:20px;">ACTIVITY LOG</h4>
        <div id="hist-area"></div>
    </div>

    <nav class="nav">
        <a href="home.html" class="nav-item"><i class="fas fa-home"></i>Home</a>
        <a href="home.html" class="nav-item"><i class="fas fa-bullseye"></i>Tasks</a>
        <a href="rank.html" class="nav-item"><i class="fas fa-trophy"></i>Rank</a>
        <a href="activity.html" class="nav-item active"><i class="fas fa-history"></i>Activity</a>
        <a href="profile.html" class="nav-item"><i class="fas fa-user"></i>Profile</a>
    </nav>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyDvtZJhIN850tU7cETuiqRyCyjCBdlFt-Y", databaseURL: "https://fynora-81313-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const tg = window.Telegram.WebApp; tg.ready();
        const uid = (tg.initDataUnsafe.user || {id:"000"}).id;

        const histArea = document.getElementById('hist-area');
        firebase.database().ref('withdrawals/pending').on('value', s => {
            histArea.innerHTML = '';
            s.forEach(c => {
                const v = c.val();
                if(v.userId == uid) {
                    histArea.innerHTML += `<div class="item-card">
                        <div><b>${v.method} Cashout</b><br><small>${new Date(v.timestamp).toLocaleDateString()}</small></div>
                        <div style="text-align:right"><b style="color:var(--acc)">${v.amount} USD</b><br><span style="color:#ffb400; font-size:0.6rem;">PENDING</span></div>
                    </div>`;
                }
            });
            if(!histArea.innerHTML) histArea.innerHTML = '<p style="text-align:center; color:var(--dim);">No recent history</p>';
        });
    </script>
</body>
</html>
